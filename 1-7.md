Approved. Proceeding with Option A ‚Äî full architectural correction, executed surgically, in-order, and with zero scope creep.

Below is the FIX PLAN ONLY (still no code yet). This is the execution contract. Once you confirm this plan, I‚Äôll move to implementation.

‚∏ª

üõ†Ô∏è ARCHITECTURAL CORRECTION PLAN (AUTHORITATIVE)

Guiding Principles (non-negotiable)
	‚Ä¢	Fix architecture first, then behavior
	‚Ä¢	Touch minimum number of files
	‚Ä¢	Preserve:
	‚Ä¢	existing UI
	‚Ä¢	existing DB tables
	‚Ä¢	existing progress data
	‚Ä¢	No feature additions
	‚Ä¢	No visual redesigns

‚∏ª

PHASE 1 ‚Äî ROUTING CANONICALIZATION (FOUNDATION)

üéØ Goal

Bring routing into strict compliance with:

/studio/course/[courseId]
/studio/course/[courseId]/lesson/[lessonId]

Actions
	1.	Create new route segments

app/studio/course/[courseId]/page.tsx
app/studio/course/[courseId]/lesson/[lessonId]/page.tsx


	2.	Deprecate (not delete yet):

app/studio/[lessonId]/page.tsx

	‚Ä¢	Will temporarily redirect to canonical route for backward compatibility

Outcome
	‚Ä¢	Studio routes now express course ‚Üí lesson hierarchy
	‚Ä¢	No learning logic runs at ambiguous URLs

‚∏ª

PHASE 2 ‚Äî RESUME LOGIC EXTRACTION (CRITICAL)

üéØ Goal

Ensure resume logic runs before StudioClientPage renders

Actions
	1.	Move resume logic into:

/studio/course/[courseId]/page.tsx


	2.	This page will:
	‚Ä¢	call getContinueLessonId(courseId)
	‚Ä¢	redirect() to:

/studio/course/[courseId]/lesson/[lessonId]


	3.	Remove resume side-effects from StudioClientPage.tsx
	‚Ä¢	No DB writes on initial render
	‚Ä¢	No ‚Äúdeciding‚Äù which lesson to show

Outcome
	‚Ä¢	Clean separation:
	‚Ä¢	Resolver page decides lesson
	‚Ä¢	StudioClientPage only renders

‚∏ª

PHASE 3 ‚Äî StudioClientPage PURIFICATION

üéØ Goal

Make StudioClientPage.tsx a pure Course Player

Actions
	1.	Remove path awareness
	‚Ä¢	‚ùå no pathId
	‚Ä¢	‚ùå no /paths/... back links
	‚Ä¢	‚ùå no curriculum assumptions
	2.	Accept only:

courseId
lessonId


	3.	Navigation rules:
	‚Ä¢	Next / Prev computed within course lessons
	‚Ä¢	Exit learning = explicit user action (not implicit path logic)

Outcome
	‚Ä¢	StudioClientPage becomes reusable, predictable, and testable
	‚Ä¢	Studio truly does not care about Paths

‚∏ª

PHASE 4 ‚Äî BACKWARD COMPATIBILITY (SAFETY NET)

üéØ Goal

Avoid breaking existing deep links or bookmarks

Actions
	1.	Old route:

/studio/[lessonId]

becomes:
	‚Ä¢	lookup lesson ‚Üí get courseId
	‚Ä¢	redirect to canonical studio route

Outcome
	‚Ä¢	Zero user-facing breakage
	‚Ä¢	Clean migration path

‚∏ª

PHASE 5 ‚Äî FINAL ARCHITECTURE RE-AUDIT

üéØ Goal

Prove correctness

We re-run the same Codex Architecture Audit.

Expected result:

ARCHITECTURE STATUS: PASS

Only then:
	‚Ä¢	Feature work resumes
	‚Ä¢	No further routing debates
	‚Ä¢	Architecture is locked

‚∏ª

FILES EXPECTED TO CHANGE (ESTIMATE)

Area	Count
Routing (new)	2‚Äì3
StudioClientPage.tsx	1
Legacy redirect	1
Total	‚â§ 5 files


‚∏ª

üîê GOVERNANCE CHECKPOINT

Before I write any code, confirm:

Reply with:

PROCEED WITH PHASE 1

Once you do:
	‚Ä¢	I will implement Phase 1 only
	‚Ä¢	Pause
	‚Ä¢	Let you review
	‚Ä¢	Then continue phase-by-phase

This keeps control entirely with you.